"use strict";define(["angular"],function(e){var t="userManageCtrl";return{route:{path:"userManage",route:{url:"/userManage",templateUrl:"tpls/userManage.html",controller:t}},ctrl:{name:t,fn:["$scope","$http",function(e,t){function a(e,t,a){if(null==e)return"未知时间";var i=new Date(e),n=i.toLocaleString();return n}function i(t,a,i){var n="",r="";return e.editUser&&(n="<a data-op='edit' data-orderby='"+a.orderby+"' data-url='"+a.url+"' data-itemName='"+a.itemName+"' data-itemId='"+a.itemId+"' class='opBtn' title='编辑用户'><span class='glyphicon glyphicon-edit'></span></a>"),e.deleteUser&&(r="<a data-op='delete' data-orderby='"+a.orderby+"' data-url='"+a.url+"' data-itemName='"+a.itemName+"' data-itemId='"+a.itemId+"' class='opBtn' title='删除用户'><span class='glyphicon glyphicon-trash'></span></a>"),n+r}e.premission=null,e.canAddUser=!0,e.editUser=e.deleteNavBtn=!1,e.ajaxRequest=function(a){var i=t({url:config.api+"/user",method:"GET",withCredentials:!0,params:a.data});null===e.premission?t({url:config.api+"/getPermission",method:"GET",withCredentials:!0,params:{functionModel:101}}).then(function(t){e.premission=t.data;var a=!0,n=!1,r=void 0;try{for(var l,d=e.premission[Symbol.iterator]();!(a=(l=d.next()).done);a=!0){var o=l.value;"addUser"===o.permissionName&&(e.canAddUser=!1),"editUser"===o.permissionName&&(e.editUser=!0),"deleteUser"===o.permissionName&&(e.deleteUser=!0)}}catch(s){n=!0,r=s}finally{try{!a&&d["return"]&&d["return"]()}finally{if(n)throw r}}return i}).then(function(e){a.success(e.data)}):i.then(function(e){a.success(e.data)})},e.tableCtrl={options:{toolbar:"#toolbar",ajax:e.ajaxRequest,rowStyle:function(e,t){return{classes:"none"}},sidePagination:"server",cache:!1,height:500,striped:!0,pagination:!0,pageSize:10,pageList:[5,10,25,50,100,200],search:!0,showColumns:!0,showRefresh:!0,minimumCountColumns:2,clickToSelect:!1,maintainSelected:!0,columns:[{field:"userName",title:"用户名",align:"center",valign:"bottom"},{field:"email",title:"邮箱",align:"center",valign:"middle"},{field:"nickName",title:"昵称",align:"center",valign:"middle"},{field:"trueName",title:"真实姓名",align:"center",valign:"middle",sortable:!0},{field:"createdAt",title:"创建时间",align:"center",valign:"middle",formatter:a,sortable:!0},{field:"updatedAt",title:"更新时间",align:"left",valign:"top",formatter:a,sortable:!0},{field:"op",title:"操作",align:"center",valign:"middle",clickToSelect:!1,formatter:i}]}},e.showAdd=function(){e.addOrEdit="add",$("#addAndEditModal").modal("show")},e.showEdit=function(t){e.navId=t.itemId,e.addOrEdit="edit",e.navName=t.itemName,e.navUrl=t.url,e.navOrderBy=t.orderby,$("#addAndEditModal").modal("show")},e.showRemove=function(t){e.navId=t.itemId,$("#deleteModal").modal("show")}}]}}});